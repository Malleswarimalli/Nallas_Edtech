<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cognitive Echo Prototype</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --attention-color: #4a90e2;
            --distracted-color: #f5a623;
            --drowsy-color: #4a2fbd;
            --neutral-color: #9b9b9b;
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(320deg, #a8c0ff, #3f2b96, #29323c);
            background-size: 200% 200%;
            animation: gradient-animation 15s ease infinite;
            overflow: hidden;
        }

        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        main {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 2rem 2.5rem;
            border-radius: 24px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 90%;
            text-align: center;
            color: #fff;
            transition: border-color 0.5s ease, box-shadow 0.5s ease;
        }

        main.attention { border-color: var(--attention-color); }
        main.distracted { border-color: var(--distracted-color); }
        main.drowsy {
            border-color: var(--drowsy-color);
            animation: pulse-glow 2s infinite alternate;
        }

        @keyframes pulse-glow {
            from { box-shadow: 0 0 10px rgba(74, 47, 189, 0.2), 0 0 20px rgba(74, 47, 189, 0.2); }
            to { box-shadow: 0 0 20px rgba(120, 90, 250, 0.7), 0 0 40px rgba(120, 90, 250, 0.7); }
        }

        h1 { font-size: 2.2rem; font-weight: 700; margin-bottom: 0.5rem; }
        h2 { font-weight: 400; font-size: 1rem; opacity: 0.8; margin-top:0; }

        #status-display {
            margin-top: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
        }

        #status-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: var(--neutral-color);
            transition: background-color 0.5s ease;
        }
        #status-indicator.attention { background-color: var(--attention-color); }
        #status-indicator.distracted { background-color: var(--distracted-color); }
        #status-indicator.drowsy { background-color: var(--drowsy-color); }

        #flashcard {
            font-size: 2.5rem;
            font-weight: 500;
            padding: 1.5rem;
            background: rgba(0,0,0,0.2);
            border-radius: 16px;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body>
    <main id="main-card">
        <h1>Cognitive Echo</h1>
        <h2>English Vocabulary Reinforcement</h2>
        <div id="flashcard-container">
             <p id="flashcard">Connecting...</p>
        </div>
        <div id="status-display">
            <div id="status-indicator"></div>
            <span id="state-text">CONNECTING...</span>
        </div>
    </main>

    <script>
        // --- THE FIX: Wait for the DOM to be fully loaded before running any code ---
        document.addEventListener('DOMContentLoaded', () => {

            // --- DYNAMIC CONTENT ---
            const vocabularyList = ['Ethereal', 'Ephemeral', 'Mellifluous'];
            let currentWordIndex = 0;

            // --- EEG SIMULATOR LOGIC ---
            const states = ['ATTENTION', 'ATTENTION', 'DISTRACTED', 'DROWSY'];
            let currentStateIndex = 0;

            function startEEGStream(callback) {
                setInterval(() => {
                    const state = states[currentStateIndex];
                    callback({ state });
                    currentStateIndex = (currentStateIndex + 1) % states.length;
                }, 3000); // Cycle every 3 seconds
            }

            // --- GET HTML ELEMENTS (now guaranteed to exist) ---
            const stateText = document.getElementById('state-text');
            const flashcard = document.getElementById('flashcard');
            const statusIndicator = document.getElementById('status-indicator');
            const mainCard = document.getElementById('main-card');
            let taggedConcept = null;

            function updateUI(eegData) {
                const state = eegData.state;
                const stateClass = state.toLowerCase();

                // Update text and colors
                stateText.textContent = state;
                statusIndicator.className = stateClass;
                mainCard.className = stateClass;
                flashcard.textContent = vocabularyList[currentWordIndex];

                if (state === 'ATTENTION') {
                    taggedConcept = flashcard.textContent;
                }

                if (state === 'DROWSY' && taggedConcept) {
                    // This is where the intervention happens.
                    // Instead of 3D, we use the CSS glow effect.
                    console.log(`Triggering intervention for: ${taggedConcept}`);
                    taggedConcept = null;
                    // Move to the next word after the intervention cycle
                    currentWordIndex = (currentWordIndex + 1) % vocabularyList.length;
                }
            }

            // --- INITIALIZE AND START THE APP ---
            console.log("DOM fully loaded. Starting simulator.");
            flashcard.textContent = vocabularyList[currentWordIndex];
            startEEGStream(updateUI);
        });
    </script>
</body>
</html>

